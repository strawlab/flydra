/* Generated by Pyrex 0.9.5.1a on Sun Feb  4 15:34:52 2007 */

#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
__PYX_EXTERN_C double pow(double, double);
#include "math.h"


typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static PyObject *__Pyx_GetExcValue(void); /*proto*/

static int __Pyx_PrintItem(PyObject *); /*proto*/
static int __Pyx_PrintNewline(void); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from reconstruct_utils */


struct __pyx_obj_17reconstruct_utils_ReconstructHelper {
  PyObject_HEAD
  float fc1;
  float fc2;
  float cc1;
  float cc2;
  float k1;
  float k2;
  float p1;
  float p2;
};

static PyTypeObject *__pyx_ptype_17reconstruct_utils_ReconstructHelper = 0;
static double __pyx_v_17reconstruct_utils_cinf;
static float __pyx_v_17reconstruct_utils_MINIMUM_ECCENTRICITY;
static float __pyx_v_17reconstruct_utils_ACCEPTABLE_DISTANCE_PIXELS;


/* Implementation of reconstruct_utils */

static char (__pyx_k2[]) = "numpy.dual";
static char (__pyx_k3[]) = "flydra.common_variables";

static PyObject *__pyx_n_numpy;
static PyObject *__pyx_n_inf;
static PyObject *__pyx_n_flydra;
static PyObject *__pyx_n_hypothesis_testing_algorithm__find_best_3d;
static PyObject *__pyx_n_find_best_3d;
static PyObject *__pyx_n_common_variables;
static PyObject *__pyx_n_MINIMUM_ECCENTRICITY;
static PyObject *__pyx_n_ACCEPTABLE_DISTANCE_PIXELS;

static PyObject *__pyx_k2p;
static PyObject *__pyx_k3p;

static int __pyx_f_17reconstruct_utils_17ReconstructHelper___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_17reconstruct_utils_17ReconstructHelper___init__[] = "create instance of ReconstructHelper\n\n        ReconstructHelper(fc1, fc2, cc1, cc2, k1, k2, p1, p2 )\n        where:\n        fc - focal length\n        cc - camera center\n        k - radial distortion parameters (non-linear)\n        p - tangential distortion parameters (non-linear)\n        ";
static int __pyx_f_17reconstruct_utils_17ReconstructHelper___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_fc1 = 0;
  PyObject *__pyx_v_fc2 = 0;
  PyObject *__pyx_v_cc1 = 0;
  PyObject *__pyx_v_cc2 = 0;
  PyObject *__pyx_v_k1 = 0;
  PyObject *__pyx_v_k2 = 0;
  PyObject *__pyx_v_p1 = 0;
  PyObject *__pyx_v_p2 = 0;
  int __pyx_r;
  float __pyx_1;
  static char *__pyx_argnames[] = {"fc1","fc2","cc1","cc2","k1","k2","p1","p2",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOOOOO", __pyx_argnames, &__pyx_v_fc1, &__pyx_v_fc2, &__pyx_v_cc1, &__pyx_v_cc2, &__pyx_v_k1, &__pyx_v_k2, &__pyx_v_p1, &__pyx_v_p2)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_fc1);
  Py_INCREF(__pyx_v_fc2);
  Py_INCREF(__pyx_v_cc1);
  Py_INCREF(__pyx_v_cc2);
  Py_INCREF(__pyx_v_k1);
  Py_INCREF(__pyx_v_k2);
  Py_INCREF(__pyx_v_p1);
  Py_INCREF(__pyx_v_p2);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":38 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_fc1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc1 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":39 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_fc2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc2 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":40 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_cc1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc1 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":41 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_cc2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc2 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":42 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_k1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k1 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":43 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_k2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k2 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":44 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_p1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p1 = __pyx_1;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":45 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_p2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; goto __pyx_L1;}
  ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2 = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("reconstruct_utils.ReconstructHelper.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_fc1);
  Py_DECREF(__pyx_v_fc2);
  Py_DECREF(__pyx_v_cc1);
  Py_DECREF(__pyx_v_cc2);
  Py_DECREF(__pyx_v_k1);
  Py_DECREF(__pyx_v_k2);
  Py_DECREF(__pyx_v_p1);
  Py_DECREF(__pyx_v_p2);
  return __pyx_r;
}

static PyObject *__pyx_n_allclose;
static PyObject *__pyx_n_get_K;
static PyObject *__pyx_n_get_nlparams;
static PyObject *__pyx_n_False;

static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper___richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op); /*proto*/
static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper___richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op) {
  PyObject *__pyx_v_op = 0;
  PyObject *__pyx_v_result;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_other);
  __pyx_v_result = Py_None; Py_INCREF(Py_None);
  __pyx_v_op = PyInt_FromLong(__pyx_arg_op); if (!__pyx_v_op) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; goto __pyx_L1;}

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":49 */
  __pyx_2 = PyInt_FromLong(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_v_op, __pyx_2, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; goto __pyx_L1;}
  __pyx_1 = __pyx_1 == 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__pyx_1) {
    __pyx_2 = PyInt_FromLong(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_op, __pyx_2, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; goto __pyx_L1;}
    __pyx_1 = __pyx_1 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
  }
  if (__pyx_1) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":50 */
    __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    __pyx_4 = PyObject_GetAttr(__pyx_3, __pyx_n_allclose); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_get_K); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    __pyx_5 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyObject_GetAttr(__pyx_v_other, __pyx_n_get_K); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    __pyx_6 = PyObject_CallObject(__pyx_3, 0); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_5);
    PyTuple_SET_ITEM(__pyx_3, 1, __pyx_6);
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_4, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_1 = PyObject_IsTrue(__pyx_2); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; goto __pyx_L1;}
    if (__pyx_1) {
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      __pyx_6 = PyObject_GetAttr(__pyx_5, __pyx_n_allclose); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_get_nlparams); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      __pyx_3 = PyObject_CallObject(__pyx_4, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_5 = PyObject_GetAttr(__pyx_v_other, __pyx_n_get_nlparams); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      __pyx_4 = PyObject_CallObject(__pyx_5, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_5, 0, __pyx_3);
      PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
      __pyx_3 = 0;
      __pyx_4 = 0;
      __pyx_2 = PyObject_CallObject(__pyx_6, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; goto __pyx_L1;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      Py_DECREF(__pyx_5); __pyx_5 = 0;
    }
    Py_DECREF(__pyx_v_result);
    __pyx_v_result = __pyx_2;
    __pyx_2 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":52 */
    __pyx_3 = PyInt_FromLong(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_op, __pyx_3, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; goto __pyx_L1;}
    __pyx_1 = __pyx_1 == 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    if (__pyx_1) {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":53 */
      __pyx_1 = PyObject_IsTrue(__pyx_v_result); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; goto __pyx_L1;}
      __pyx_4 = PyInt_FromLong((!__pyx_1)); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; goto __pyx_L1;}
      Py_DECREF(__pyx_v_result);
      __pyx_v_result = __pyx_4;
      __pyx_4 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":55 */
    __pyx_6 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    Py_DECREF(__pyx_v_result);
    __pyx_v_result = __pyx_6;
    __pyx_6 = 0;
  }
  __pyx_L2:;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":56 */
  Py_INCREF(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("reconstruct_utils.ReconstructHelper.__richcmp__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_op);
  Py_DECREF(__pyx_v_result);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_other);
  return __pyx_r;
}

static PyObject *__pyx_n_array;

static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_get_K(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_get_K(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_K;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);
  __pyx_v_K = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":59 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_array); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  __pyx_4 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(3); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; goto __pyx_L1;}
  __pyx_3 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; goto __pyx_L1;}
  __pyx_4 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_6, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
  __pyx_7 = PyTuple_New(3); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_7, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_7, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_7, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_5);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_6);
  PyTuple_SET_ITEM(__pyx_1, 2, __pyx_7);
  __pyx_5 = 0;
  __pyx_6 = 0;
  __pyx_7 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_K);
  __pyx_v_K = __pyx_4;
  __pyx_4 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":62 */
  Py_INCREF(__pyx_v_K);
  __pyx_r = __pyx_v_K;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  __Pyx_AddTraceback("reconstruct_utils.ReconstructHelper.get_K");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_K);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_get_nlparams(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_get_nlparams(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":65 */
  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  __pyx_3 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  __pyx_4 = PyFloat_FromDouble(((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_2);
  PyTuple_SET_ITEM(__pyx_5, 2, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 3, __pyx_4);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_r = __pyx_5;
  __pyx_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("reconstruct_utils.ReconstructHelper.get_nlparams");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_undistort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_17reconstruct_utils_17ReconstructHelper_undistort[] = "undistort 2D coordinate pair\n\n        Iteratively performs an undistortion using camera intrinsic\n        parameters.\n\n        Implementation translated from CalTechCal.\n\n        See also the OpenCV reference manual, which has the equation\n        used.\n        ";
static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_undistort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_x_kk;
  float __pyx_v_y_kk;
  float __pyx_v_xl;
  float __pyx_v_yl;
  float __pyx_v_xd;
  float __pyx_v_yd;
  float __pyx_v_x;
  float __pyx_v_y;
  float __pyx_v_r_2;
  float __pyx_v_k_radial;
  float __pyx_v_delta_x;
  float __pyx_v_delta_y;
  int __pyx_v_i;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"x_kk","y_kk",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "ff", __pyx_argnames, &__pyx_v_x_kk, &__pyx_v_y_kk)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":87 */
  __pyx_v_xd = ((__pyx_v_x_kk - ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc1) / ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc1);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":88 */
  __pyx_v_yd = ((__pyx_v_y_kk - ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc2) / ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc2);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":93 */
  __pyx_v_x = __pyx_v_xd;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":94 */
  __pyx_v_y = __pyx_v_yd;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":96 */
  for (__pyx_v_i = 0; __pyx_v_i < 20; ++__pyx_v_i) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":97 */
    __pyx_v_r_2 = ((__pyx_v_x * __pyx_v_x) + (__pyx_v_y * __pyx_v_y));

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":98 */
    __pyx_v_k_radial = ((1.0 + (((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k1 * __pyx_v_r_2)) + ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k2 * __pyx_v_r_2) * __pyx_v_r_2));

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":99 */
    __pyx_v_delta_x = ((((2.0 * ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p1) * __pyx_v_x) * __pyx_v_y) + (((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2 * (__pyx_v_r_2 + ((2.0 * __pyx_v_x) * __pyx_v_x))));

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":100 */
    __pyx_v_delta_y = ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p1 * (__pyx_v_r_2 + ((2.0 * __pyx_v_y) * __pyx_v_y))) + (((2.0 * ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2) * __pyx_v_x) * __pyx_v_y));

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":101 */
    __pyx_v_x = ((__pyx_v_xd - __pyx_v_delta_x) / __pyx_v_k_radial);

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":102 */
    __pyx_v_y = ((__pyx_v_yd - __pyx_v_delta_y) / __pyx_v_k_radial);
  }

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":106 */
  __pyx_v_xl = ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc1 * __pyx_v_x) + ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc1);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":107 */
  __pyx_v_yl = ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc2 * __pyx_v_y) + ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc2);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":108 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_xl); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_yl); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("reconstruct_utils.ReconstructHelper.undistort");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_17reconstruct_utils_17ReconstructHelper_distort[] = "distort 2D coordinate pair";
static PyObject *__pyx_f_17reconstruct_utils_17ReconstructHelper_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_xl;
  float __pyx_v_yl;
  float __pyx_v_x;
  float __pyx_v_y;
  float __pyx_v_r_2;
  float __pyx_v_term1;
  float __pyx_v_xd;
  float __pyx_v_yd;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"xl","yl",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "ff", __pyx_argnames, &__pyx_v_xl, &__pyx_v_yl)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":115 */
  __pyx_v_x = ((__pyx_v_xl - ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc1) / ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc1);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":116 */
  __pyx_v_y = ((__pyx_v_yl - ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc2) / ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc2);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":118 */
  __pyx_v_r_2 = ((__pyx_v_x * __pyx_v_x) + (__pyx_v_y * __pyx_v_y));

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":119 */
  __pyx_v_term1 = ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k1 * __pyx_v_r_2) + (((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->k2 * pow(__pyx_v_r_2, 2)));

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":120 */
  __pyx_v_xd = ((__pyx_v_x + (__pyx_v_x * __pyx_v_term1)) + ((((2 * ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p1) * __pyx_v_x) * __pyx_v_y) + (((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2 * (__pyx_v_r_2 + (2 * pow(__pyx_v_x, 2))))));

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":124 */
  __pyx_v_yd = ((__pyx_v_y + (__pyx_v_y * __pyx_v_term1)) + ((((2 * ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2) * __pyx_v_x) * __pyx_v_y) + (((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->p2 * (__pyx_v_r_2 + (2 * pow(__pyx_v_y, 2))))));

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":126 */
  __pyx_v_xd = ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc1 * __pyx_v_xd) + ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc1);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":127 */
  __pyx_v_yd = ((((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->fc2 * __pyx_v_yd) + ((struct __pyx_obj_17reconstruct_utils_ReconstructHelper *)__pyx_v_self)->cc2);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":129 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_xd); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_yd); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("reconstruct_utils.ReconstructHelper.distort");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_dual;
static PyObject *__pyx_n_svd;
static PyObject *__pyx_n_cam_ids;
static PyObject *__pyx_n_len;
static PyObject *__pyx_n_ValueError;
static PyObject *__pyx_n_zeros;
static PyObject *__pyx_n_float64;
static PyObject *__pyx_n_dtype;
static PyObject *__pyx_n_Pmat;
static PyObject *__pyx_n_enumerate;
static PyObject *__pyx_n_KeyError;
static PyObject *__pyx_n_append;
static PyObject *__pyx_n_cam_combinations_by_size;
static PyObject *__pyx_n_extend;
static PyObject *__pyx_n_dot;
static PyObject *__pyx_n_True;
static PyObject *__pyx_n_full_matrices;
static PyObject *__pyx_n_linalg;
static PyObject *__pyx_n_LinAlgError;
static PyObject *__pyx_n_repr;

static PyObject *__pyx_k4p;
static PyObject *__pyx_k7p;

static char (__pyx_k4[]) = "too many cameras -- MAX_CAMERAS = %d";
static char (__pyx_k7[]) = "SVD error, P=";

static PyObject *__pyx_f_17reconstruct_utils_hypothesis_testing_algorithm__find_best_3d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_17reconstruct_utils_hypothesis_testing_algorithm__find_best_3d[] = "Use hypothesis testing algorithm to find best 3D point\n    \n    Finds combination of cameras which uses the most number of cameras\n    while minimizing mean reprojection error. Algorithm used accepts\n    any camera combination with reprojection error less than the\n    global variable ACCEPTABLE_DISTANCE_PIXELS.\n\n    ";
static PyObject *__pyx_f_17reconstruct_utils_hypothesis_testing_algorithm__find_best_3d(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_recon = 0;
  PyObject *__pyx_v_d2 = 0;
  int __pyx_v_max_n_cams;
  int __pyx_v_n_cams;
  int __pyx_v_best_n_cams;
  int __pyx_v_i;
  int __pyx_v_missing_cam_data;
  double __pyx_v_alpha;
  double __pyx_v_x;
  double __pyx_v_y;
  double __pyx_v_orig_x;
  double __pyx_v_orig_y;
  double __pyx_v_new_x;
  double __pyx_v_new_y;
  double __pyx_v_dist;
  double __pyx_v_mean_dist;
  double __pyx_v_least_err;
  int __pyx_v_MAX_CAMERAS;
  double (__pyx_v_least_err_by_n_cameras[10]);
  PyObject *__pyx_v_svd;
  PyObject *__pyx_v_cam_ids;
  PyObject *__pyx_v_allA;
  PyObject *__pyx_v_bad_cam_ids;
  PyObject *__pyx_v_cam_id2idx;
  PyObject *__pyx_v_all2d;
  PyObject *__pyx_v_Pmat_fastnx;
  PyObject *__pyx_v_cam_id;
  PyObject *__pyx_v_value_tuple;
  PyObject *__pyx_v_xy_values;
  PyObject *__pyx_v_Pmat;
  PyObject *__pyx_v_row3;
  PyObject *__pyx_v_cam_ids_for_least_err;
  PyObject *__pyx_v_X_for_least_err;
  PyObject *__pyx_v_cam_ids_used;
  PyObject *__pyx_v_good_A_idx;
  PyObject *__pyx_v_A;
  PyObject *__pyx_v_u;
  PyObject *__pyx_v_d;
  PyObject *__pyx_v_vt;
  PyObject *__pyx_v_X;
  PyObject *__pyx_v_new_xyw;
  PyObject *__pyx_v_P;
  PyObject *__pyx_v_area;
  PyObject *__pyx_v_slope;
  PyObject *__pyx_v_eccentricity;
  PyObject *__pyx_v_p1;
  PyObject *__pyx_v_p2;
  PyObject *__pyx_v_p3;
  PyObject *__pyx_v_p4;
  PyObject *__pyx_v_Lcoords;
  PyObject *__pyx_v_err;
  PyObject *__pyx_v_Q;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  double __pyx_7;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  static char *__pyx_argnames[] = {"recon","d2",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_recon, &__pyx_v_d2)) return 0;
  Py_INCREF(__pyx_v_recon);
  Py_INCREF(__pyx_v_d2);
  __pyx_v_svd = Py_None; Py_INCREF(Py_None);
  __pyx_v_cam_ids = Py_None; Py_INCREF(Py_None);
  __pyx_v_allA = Py_None; Py_INCREF(Py_None);
  __pyx_v_bad_cam_ids = Py_None; Py_INCREF(Py_None);
  __pyx_v_cam_id2idx = Py_None; Py_INCREF(Py_None);
  __pyx_v_all2d = Py_None; Py_INCREF(Py_None);
  __pyx_v_Pmat_fastnx = Py_None; Py_INCREF(Py_None);
  __pyx_v_cam_id = Py_None; Py_INCREF(Py_None);
  __pyx_v_value_tuple = Py_None; Py_INCREF(Py_None);
  __pyx_v_xy_values = Py_None; Py_INCREF(Py_None);
  __pyx_v_Pmat = Py_None; Py_INCREF(Py_None);
  __pyx_v_row3 = Py_None; Py_INCREF(Py_None);
  __pyx_v_cam_ids_for_least_err = Py_None; Py_INCREF(Py_None);
  __pyx_v_X_for_least_err = Py_None; Py_INCREF(Py_None);
  __pyx_v_cam_ids_used = Py_None; Py_INCREF(Py_None);
  __pyx_v_good_A_idx = Py_None; Py_INCREF(Py_None);
  __pyx_v_A = Py_None; Py_INCREF(Py_None);
  __pyx_v_u = Py_None; Py_INCREF(Py_None);
  __pyx_v_d = Py_None; Py_INCREF(Py_None);
  __pyx_v_vt = Py_None; Py_INCREF(Py_None);
  __pyx_v_X = Py_None; Py_INCREF(Py_None);
  __pyx_v_new_xyw = Py_None; Py_INCREF(Py_None);
  __pyx_v_P = Py_None; Py_INCREF(Py_None);
  __pyx_v_area = Py_None; Py_INCREF(Py_None);
  __pyx_v_slope = Py_None; Py_INCREF(Py_None);
  __pyx_v_eccentricity = Py_None; Py_INCREF(Py_None);
  __pyx_v_p1 = Py_None; Py_INCREF(Py_None);
  __pyx_v_p2 = Py_None; Py_INCREF(Py_None);
  __pyx_v_p3 = Py_None; Py_INCREF(Py_None);
  __pyx_v_p4 = Py_None; Py_INCREF(Py_None);
  __pyx_v_Lcoords = Py_None; Py_INCREF(Py_None);
  __pyx_v_err = Py_None; Py_INCREF(Py_None);
  __pyx_v_Q = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":151 */
  __pyx_v_MAX_CAMERAS = 10;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":153 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_dual); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_svd); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_svd);
  __pyx_v_svd = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":155 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_recon, __pyx_n_cam_ids); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  Py_DECREF(__pyx_v_cam_ids);
  __pyx_v_cam_ids = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":156 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; goto __pyx_L1;}
  Py_INCREF(__pyx_v_cam_ids);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_cam_ids);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_v_max_n_cams = __pyx_4;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":157 */
  __pyx_4 = (__pyx_v_max_n_cams > __pyx_v_MAX_CAMERAS);
  if (__pyx_4) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":158 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    __pyx_2 = PyInt_FromLong(__pyx_v_MAX_CAMERAS); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyNumber_Remainder(__pyx_k4p, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":162 */
  for (__pyx_v_i = 0; __pyx_v_i <= __pyx_v_max_n_cams; ++__pyx_v_i) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":163 */
    (__pyx_v_least_err_by_n_cameras[__pyx_v_i]) = __pyx_v_17reconstruct_utils_cinf;
  }

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":165 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_zeros); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_2 = PyInt_FromLong((2 * __pyx_v_max_n_cams)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_1);
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_5);
  __pyx_5 = 0;
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  __pyx_6 = PyObject_GetAttr(__pyx_5, __pyx_n_float64); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  if (PyDict_SetItem(__pyx_1, __pyx_n_dtype, __pyx_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  __pyx_5 = PyEval_CallObjectWithKeywords(__pyx_3, __pyx_2, __pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_allA);
  __pyx_v_allA = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":166 */
  __pyx_6 = PyList_New(0); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; goto __pyx_L1;}
  Py_DECREF(__pyx_v_bad_cam_ids);
  __pyx_v_bad_cam_ids = __pyx_6;
  __pyx_6 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":167 */
  __pyx_3 = PyDict_New(); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; goto __pyx_L1;}
  Py_DECREF(__pyx_v_cam_id2idx);
  __pyx_v_cam_id2idx = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":168 */
  __pyx_2 = PyDict_New(); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; goto __pyx_L1;}
  Py_DECREF(__pyx_v_all2d);
  __pyx_v_all2d = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":169 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_recon, __pyx_n_Pmat); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; goto __pyx_L1;}
  Py_DECREF(__pyx_v_Pmat_fastnx);
  __pyx_v_Pmat_fastnx = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":170 */
  __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_enumerate); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  Py_INCREF(__pyx_v_cam_ids);
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_v_cam_ids);
  __pyx_3 = PyObject_CallObject(__pyx_5, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  __pyx_2 = PyObject_GetIter(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  for (;;) {
    __pyx_1 = PyIter_Next(__pyx_2);
    if (!__pyx_1) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
      break;
    }
    __pyx_5 = PyObject_GetIter(__pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_6 = __Pyx_UnpackItem(__pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
    __pyx_4 = PyInt_AsLong(__pyx_6); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_v_i = __pyx_4;
    __pyx_3 = __Pyx_UnpackItem(__pyx_5); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
    Py_DECREF(__pyx_v_cam_id);
    __pyx_v_cam_id = __pyx_3;
    __pyx_3 = 0;
    if (__Pyx_EndUnpack(__pyx_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":171 */
    __pyx_1 = PyInt_FromLong(__pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; goto __pyx_L1;}
    if (PyObject_SetItem(__pyx_v_cam_id2idx, __pyx_v_cam_id, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":174 */
    /*try:*/ {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":175 */
      __pyx_6 = PyObject_GetItem(__pyx_v_d2, __pyx_v_cam_id); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L7;}
      Py_DECREF(__pyx_v_value_tuple);
      __pyx_v_value_tuple = __pyx_6;
      __pyx_6 = 0;
    }
    goto __pyx_L8;
    __pyx_L7:;
    Py_XDECREF(__pyx_3); __pyx_3 = 0;
    Py_XDECREF(__pyx_5); __pyx_5 = 0;
    Py_XDECREF(__pyx_1); __pyx_1 = 0;
    Py_XDECREF(__pyx_6); __pyx_6 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":176 */
    __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_KeyError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; goto __pyx_L1;}
    __pyx_4 = PyErr_ExceptionMatches(__pyx_3);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    if (__pyx_4) {
      __Pyx_AddTraceback("reconstruct_utils.hypothesis_testing_algorithm__find_best_3d");
      __pyx_5 = __Pyx_GetExcValue(); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":177 */
      __pyx_1 = PyObject_GetAttr(__pyx_v_bad_cam_ids, __pyx_n_append); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; goto __pyx_L1;}
      __pyx_6 = PyTuple_New(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; goto __pyx_L1;}
      Py_INCREF(__pyx_v_cam_id);
      PyTuple_SET_ITEM(__pyx_6, 0, __pyx_v_cam_id);
      __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":178 */
      goto __pyx_L5;
      goto __pyx_L8;
    }
    goto __pyx_L1;
    __pyx_L8:;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":181 */
    __pyx_5 = PySequence_GetSlice(__pyx_v_value_tuple, 0, 2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; goto __pyx_L1;}
    Py_DECREF(__pyx_v_xy_values);
    __pyx_v_xy_values = __pyx_5;
    __pyx_5 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":182 */
    __pyx_1 = PyObject_GetIter(__pyx_v_xy_values); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; goto __pyx_L1;}
    __pyx_6 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; goto __pyx_L1;}
    __pyx_7 = PyFloat_AsDouble(__pyx_6); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_v_x = __pyx_7;
    __pyx_3 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; goto __pyx_L1;}
    __pyx_7 = PyFloat_AsDouble(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_v_y = __pyx_7;
    if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":183 */
    __pyx_4 = isnan(__pyx_v_x);
    if (__pyx_4) {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":184 */
      __pyx_5 = PyObject_GetAttr(__pyx_v_bad_cam_ids, __pyx_n_append); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; goto __pyx_L1;}
      __pyx_6 = PyTuple_New(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; goto __pyx_L1;}
      Py_INCREF(__pyx_v_cam_id);
      PyTuple_SET_ITEM(__pyx_6, 0, __pyx_v_cam_id);
      __pyx_3 = PyObject_CallObject(__pyx_5, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":185 */
      goto __pyx_L5;
      goto __pyx_L9;
    }
    __pyx_L9:;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":188 */
    __pyx_1 = PyObject_GetItem(__pyx_v_Pmat_fastnx, __pyx_v_cam_id); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; goto __pyx_L1;}
    Py_DECREF(__pyx_v_Pmat);
    __pyx_v_Pmat = __pyx_1;
    __pyx_1 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":189 */
    __pyx_5 = PyInt_FromLong(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; goto __pyx_L1;}
    __pyx_6 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_5);
    PyTuple_SET_ITEM(__pyx_3, 1, __pyx_6);
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_1 = PyObject_GetItem(__pyx_v_Pmat, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_v_row3);
    __pyx_v_row3 = __pyx_1;
    __pyx_1 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":190 */
    __pyx_5 = PyFloat_FromDouble(__pyx_v_x); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    __pyx_6 = PyNumber_Multiply(__pyx_5, __pyx_v_row3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    __pyx_1 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_1);
    __pyx_3 = 0;
    __pyx_1 = 0;
    __pyx_3 = PyObject_GetItem(__pyx_v_Pmat, __pyx_5); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_1 = PyNumber_Subtract(__pyx_6, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_5 = PyInt_FromLong((__pyx_v_i * 2)); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    __pyx_6 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_5);
    PyTuple_SET_ITEM(__pyx_3, 1, __pyx_6);
    __pyx_5 = 0;
    __pyx_6 = 0;
    if (PyObject_SetItem(__pyx_v_allA, __pyx_3, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":191 */
    __pyx_5 = PyFloat_FromDouble(__pyx_v_y); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    __pyx_6 = PyNumber_Multiply(__pyx_5, __pyx_v_row3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_1 = PyInt_FromLong(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_3);
    __pyx_1 = 0;
    __pyx_3 = 0;
    __pyx_1 = PyObject_GetItem(__pyx_v_Pmat, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_3 = PyNumber_Subtract(__pyx_6, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_5 = PyInt_FromLong(((__pyx_v_i * 2) + 1)); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    __pyx_6 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_5);
    PyTuple_SET_ITEM(__pyx_1, 1, __pyx_6);
    __pyx_5 = 0;
    __pyx_6 = 0;
    if (PyObject_SetItem(__pyx_v_allA, __pyx_1, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":193 */
    if (PyObject_SetItem(__pyx_v_all2d, __pyx_v_cam_id, __pyx_v_xy_values) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; goto __pyx_L1;}
    __pyx_L5:;
  }
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":195 */
  __pyx_5 = PyDict_New(); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; goto __pyx_L1;}
  Py_DECREF(__pyx_v_cam_ids_for_least_err);
  __pyx_v_cam_ids_for_least_err = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":196 */
  __pyx_6 = PyDict_New(); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; goto __pyx_L1;}
  Py_DECREF(__pyx_v_X_for_least_err);
  __pyx_v_X_for_least_err = __pyx_6;
  __pyx_6 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":197 */
  for (__pyx_v_n_cams = 2; __pyx_v_n_cams <= __pyx_v_max_n_cams; ++__pyx_v_n_cams) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":205 */
    __pyx_v_alpha = (1.0 / __pyx_v_n_cams);

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":209 */
    __pyx_4 = (!isinf((__pyx_v_least_err_by_n_cameras[(__pyx_v_n_cams - 2)])));
    if (__pyx_4) {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":211 */
      __pyx_4 = ((__pyx_v_least_err_by_n_cameras[(__pyx_v_n_cams - 1)]) > __pyx_v_17reconstruct_utils_ACCEPTABLE_DISTANCE_PIXELS);
      if (__pyx_4) {

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":213 */
        goto __pyx_L11;
        goto __pyx_L13;
      }
      __pyx_L13:;
      goto __pyx_L12;
    }
    __pyx_L12:;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":215 */
    __pyx_3 = PyObject_GetAttr(__pyx_v_recon, __pyx_n_cam_combinations_by_size); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(__pyx_v_n_cams); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; goto __pyx_L1;}
    __pyx_2 = PyObject_GetItem(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_5 = PyObject_GetIter(__pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    for (;;) {
      __pyx_6 = PyIter_Next(__pyx_5);
      if (!__pyx_6) {
        if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; goto __pyx_L1;}
        break;
      }
      Py_DECREF(__pyx_v_cam_ids_used);
      __pyx_v_cam_ids_used = __pyx_6;
      __pyx_6 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":216 */
      __pyx_v_missing_cam_data = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":217 */
      __pyx_3 = PyList_New(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
      Py_DECREF(__pyx_v_good_A_idx);
      __pyx_v_good_A_idx = __pyx_3;
      __pyx_3 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":218 */
      __pyx_1 = PyObject_GetIter(__pyx_v_cam_ids_used); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; goto __pyx_L1;}
      for (;;) {
        __pyx_2 = PyIter_Next(__pyx_1);
        if (!__pyx_2) {
          if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; goto __pyx_L1;}
          break;
        }
        Py_DECREF(__pyx_v_cam_id);
        __pyx_v_cam_id = __pyx_2;
        __pyx_2 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":219 */
        __pyx_4 = PySequence_Contains(__pyx_v_bad_cam_ids, __pyx_v_cam_id); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; goto __pyx_L1;}
        if (__pyx_4) {

          /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":220 */
          __pyx_v_missing_cam_data = 1;

          /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":221 */
          goto __pyx_L17;
          goto __pyx_L18;
        }
        /*else*/ {

          /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":223 */
          __pyx_6 = PyObject_GetItem(__pyx_v_cam_id2idx, __pyx_v_cam_id); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; goto __pyx_L1;}
          __pyx_4 = PyInt_AsLong(__pyx_6); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; goto __pyx_L1;}
          Py_DECREF(__pyx_6); __pyx_6 = 0;
          __pyx_v_i = __pyx_4;

          /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":224 */
          __pyx_3 = PyObject_GetAttr(__pyx_v_good_A_idx, __pyx_n_extend); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; goto __pyx_L1;}
          __pyx_2 = PyInt_FromLong((__pyx_v_i * 2)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; goto __pyx_L1;}
          __pyx_6 = PyInt_FromLong(((__pyx_v_i * 2) + 1)); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; goto __pyx_L1;}
          __pyx_8 = PyTuple_New(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; goto __pyx_L1;}
          PyTuple_SET_ITEM(__pyx_8, 0, __pyx_2);
          PyTuple_SET_ITEM(__pyx_8, 1, __pyx_6);
          __pyx_2 = 0;
          __pyx_6 = 0;
          __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; goto __pyx_L1;}
          PyTuple_SET_ITEM(__pyx_2, 0, __pyx_8);
          __pyx_8 = 0;
          __pyx_6 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; goto __pyx_L1;}
          Py_DECREF(__pyx_3); __pyx_3 = 0;
          Py_DECREF(__pyx_2); __pyx_2 = 0;
          Py_DECREF(__pyx_6); __pyx_6 = 0;
        }
        __pyx_L18:;
      }
      __pyx_L17:;
      Py_DECREF(__pyx_1); __pyx_1 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":225 */
      __pyx_4 = (__pyx_v_missing_cam_data == 1);
      if (__pyx_4) {

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":226 */
        goto __pyx_L14;
        goto __pyx_L19;
      }
      __pyx_L19:;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":227 */
      __pyx_8 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
      __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
      Py_INCREF(__pyx_v_good_A_idx);
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_good_A_idx);
      PyTuple_SET_ITEM(__pyx_3, 1, __pyx_8);
      __pyx_8 = 0;
      __pyx_2 = PyObject_GetItem(__pyx_v_allA, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_v_A);
      __pyx_v_A = __pyx_2;
      __pyx_2 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":228 */
      __pyx_6 = PyTuple_New(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_INCREF(__pyx_v_A);
      PyTuple_SET_ITEM(__pyx_6, 0, __pyx_v_A);
      __pyx_1 = PyObject_CallObject(__pyx_v_svd, __pyx_6); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      __pyx_8 = PyObject_GetIter(__pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_3 = __Pyx_UnpackItem(__pyx_8); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_DECREF(__pyx_v_u);
      __pyx_v_u = __pyx_3;
      __pyx_3 = 0;
      __pyx_2 = __Pyx_UnpackItem(__pyx_8); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_DECREF(__pyx_v_d);
      __pyx_v_d = __pyx_2;
      __pyx_2 = 0;
      __pyx_6 = __Pyx_UnpackItem(__pyx_8); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_DECREF(__pyx_v_vt);
      __pyx_v_vt = __pyx_6;
      __pyx_6 = 0;
      if (__Pyx_EndUnpack(__pyx_8) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":229 */
      __pyx_1 = PyInt_FromLong((-1)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
      PyTuple_SET_ITEM(__pyx_2, 1, __pyx_3);
      __pyx_1 = 0;
      __pyx_3 = 0;
      __pyx_6 = PyObject_GetItem(__pyx_v_vt, __pyx_2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_8 = PyInt_FromLong((-1)); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_8);
      PyTuple_SET_ITEM(__pyx_3, 1, __pyx_1);
      __pyx_8 = 0;
      __pyx_1 = 0;
      __pyx_2 = PyObject_GetItem(__pyx_v_vt, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_8 = PyNumber_Divide(__pyx_6, __pyx_2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      Py_DECREF(__pyx_v_X);
      __pyx_v_X = __pyx_8;
      __pyx_8 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":231 */
      __pyx_v_mean_dist = 0.0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":232 */
      __pyx_1 = PyObject_GetIter(__pyx_v_cam_ids_used); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
      for (;;) {
        __pyx_3 = PyIter_Next(__pyx_1);
        if (!__pyx_3) {
          if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
          break;
        }
        Py_DECREF(__pyx_v_cam_id);
        __pyx_v_cam_id = __pyx_3;
        __pyx_3 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":233 */
        __pyx_6 = PyObject_GetItem(__pyx_v_all2d, __pyx_v_cam_id); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        __pyx_2 = PyObject_GetIter(__pyx_6); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        Py_DECREF(__pyx_6); __pyx_6 = 0;
        __pyx_8 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        __pyx_7 = PyFloat_AsDouble(__pyx_8); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        __pyx_v_orig_x = __pyx_7;
        __pyx_3 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        __pyx_7 = PyFloat_AsDouble(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        Py_DECREF(__pyx_3); __pyx_3 = 0;
        __pyx_v_orig_y = __pyx_7;
        if (__Pyx_EndUnpack(__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":234 */
        __pyx_6 = PyObject_GetItem(__pyx_v_Pmat_fastnx, __pyx_v_cam_id); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
        Py_DECREF(__pyx_v_Pmat);
        __pyx_v_Pmat = __pyx_6;
        __pyx_6 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":235 */
        __pyx_8 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
        __pyx_3 = PyObject_GetAttr(__pyx_8, __pyx_n_dot); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
        Py_INCREF(__pyx_v_Pmat);
        PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_Pmat);
        Py_INCREF(__pyx_v_X);
        PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_X);
        __pyx_6 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
        Py_DECREF(__pyx_3); __pyx_3 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_v_new_xyw);
        __pyx_v_new_xyw = __pyx_6;
        __pyx_6 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":236 */
        __pyx_8 = PySequence_GetSlice(__pyx_v_new_xyw, 0, 2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        __pyx_3 = PyInt_FromLong(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        __pyx_2 = PyObject_GetItem(__pyx_v_new_xyw, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        Py_DECREF(__pyx_3); __pyx_3 = 0;
        __pyx_6 = PyNumber_Divide(__pyx_8, __pyx_2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        __pyx_3 = PyObject_GetIter(__pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        Py_DECREF(__pyx_6); __pyx_6 = 0;
        __pyx_8 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        __pyx_7 = PyFloat_AsDouble(__pyx_8); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        __pyx_v_new_x = __pyx_7;
        __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        __pyx_7 = PyFloat_AsDouble(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        __pyx_v_new_y = __pyx_7;
        if (__Pyx_EndUnpack(__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
        Py_DECREF(__pyx_3); __pyx_3 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":238 */
        __pyx_v_dist = sqrt((pow((__pyx_v_orig_x - __pyx_v_new_x), 2) + pow((__pyx_v_orig_y - __pyx_v_new_y), 2)));

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":239 */
        __pyx_v_mean_dist = (__pyx_v_mean_dist + (__pyx_v_dist * __pyx_v_alpha));
      }
      Py_DECREF(__pyx_1); __pyx_1 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":241 */
      __pyx_v_least_err = (__pyx_v_least_err_by_n_cameras[__pyx_v_n_cams]);

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":242 */
      __pyx_4 = (__pyx_v_mean_dist < __pyx_v_least_err);
      if (__pyx_4) {

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":243 */
        (__pyx_v_least_err_by_n_cameras[__pyx_v_n_cams]) = __pyx_v_mean_dist;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":244 */
        __pyx_6 = PyInt_FromLong(__pyx_v_n_cams); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
        if (PyObject_SetItem(__pyx_v_cam_ids_for_least_err, __pyx_6, __pyx_v_cam_ids_used) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
        Py_DECREF(__pyx_6); __pyx_6 = 0;

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":245 */
        __pyx_8 = PySequence_GetSlice(__pyx_v_X, 0, 3); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; goto __pyx_L1;}
        __pyx_2 = PyInt_FromLong(__pyx_v_n_cams); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; goto __pyx_L1;}
        if (PyObject_SetItem(__pyx_v_X_for_least_err, __pyx_2, __pyx_8) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; goto __pyx_L1;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        goto __pyx_L22;
      }
      __pyx_L22:;
      __pyx_L14:;
    }
    Py_DECREF(__pyx_5); __pyx_5 = 0;
  }
  __pyx_L11:;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":248 */
  __pyx_v_best_n_cams = 2;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":249 */
  __pyx_v_least_err = (__pyx_v_least_err_by_n_cameras[2]);

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":250 */
  __pyx_v_mean_dist = __pyx_v_least_err;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":251 */
  for (__pyx_v_n_cams = 3; __pyx_v_n_cams <= __pyx_v_max_n_cams; ++__pyx_v_n_cams) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":252 */
    __pyx_v_least_err = (__pyx_v_least_err_by_n_cameras[__pyx_v_n_cams]);

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":253 */
    __pyx_4 = isinf(__pyx_v_least_err);
    if (__pyx_4) {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":254 */
      goto __pyx_L24;
      goto __pyx_L25;
    }
    __pyx_L25:;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":255 */
    __pyx_4 = (__pyx_v_least_err < __pyx_v_17reconstruct_utils_ACCEPTABLE_DISTANCE_PIXELS);
    if (__pyx_4) {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":256 */
      __pyx_v_mean_dist = __pyx_v_least_err;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":257 */
      __pyx_v_best_n_cams = __pyx_v_n_cams;
      goto __pyx_L26;
    }
    __pyx_L26:;
  }
  __pyx_L24:;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":260 */
  __pyx_3 = PyInt_FromLong(__pyx_v_best_n_cams); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  __pyx_1 = PyObject_GetItem(__pyx_v_cam_ids_for_least_err, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_cam_ids_used);
  __pyx_v_cam_ids_used = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":261 */
  __pyx_6 = PyInt_FromLong(__pyx_v_best_n_cams); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; goto __pyx_L1;}
  __pyx_8 = PyObject_GetItem(__pyx_v_X_for_least_err, __pyx_6); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_v_X);
  __pyx_v_X = __pyx_8;
  __pyx_8 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":264 */
  __pyx_2 = PyList_New(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; goto __pyx_L1;}
  Py_DECREF(__pyx_v_P);
  __pyx_v_P = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":265 */
  __pyx_5 = PyObject_GetIter(__pyx_v_cam_ids_used); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  for (;;) {
    __pyx_3 = PyIter_Next(__pyx_5);
    if (!__pyx_3) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
      break;
    }
    Py_DECREF(__pyx_v_cam_id);
    __pyx_v_cam_id = __pyx_3;
    __pyx_3 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":266 */
    __pyx_1 = PyObject_GetItem(__pyx_v_d2, __pyx_v_cam_id); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    __pyx_6 = PyObject_GetIter(__pyx_1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_8 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    __pyx_7 = PyFloat_AsDouble(__pyx_8); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_v_x = __pyx_7;
    __pyx_2 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    __pyx_7 = PyFloat_AsDouble(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_y = __pyx_7;
    __pyx_3 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_area);
    __pyx_v_area = __pyx_3;
    __pyx_3 = 0;
    __pyx_1 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_slope);
    __pyx_v_slope = __pyx_1;
    __pyx_1 = 0;
    __pyx_8 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_eccentricity);
    __pyx_v_eccentricity = __pyx_8;
    __pyx_8 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_p1);
    __pyx_v_p1 = __pyx_2;
    __pyx_2 = 0;
    __pyx_3 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_p2);
    __pyx_v_p2 = __pyx_3;
    __pyx_3 = 0;
    __pyx_1 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_p3);
    __pyx_v_p3 = __pyx_1;
    __pyx_1 = 0;
    __pyx_8 = __Pyx_UnpackItem(__pyx_6); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_v_p4);
    __pyx_v_p4 = __pyx_8;
    __pyx_8 = 0;
    if (__Pyx_EndUnpack(__pyx_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":267 */
    __pyx_2 = PyFloat_FromDouble(__pyx_v_17reconstruct_utils_MINIMUM_ECCENTRICITY); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_v_eccentricity, __pyx_2, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; goto __pyx_L1;}
    __pyx_4 = __pyx_4 > 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_4) {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":268 */
      __pyx_3 = PyObject_GetAttr(__pyx_v_P, __pyx_n_append); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; goto __pyx_L1;}
      __pyx_1 = PyTuple_New(4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; goto __pyx_L1;}
      Py_INCREF(__pyx_v_p1);
      PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_p1);
      Py_INCREF(__pyx_v_p2);
      PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_p2);
      Py_INCREF(__pyx_v_p3);
      PyTuple_SET_ITEM(__pyx_1, 2, __pyx_v_p3);
      Py_INCREF(__pyx_v_p4);
      PyTuple_SET_ITEM(__pyx_1, 3, __pyx_v_p4);
      __pyx_8 = PyTuple_New(1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_8, 0, __pyx_1);
      __pyx_1 = 0;
      __pyx_6 = PyObject_CallObject(__pyx_3, __pyx_8); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      goto __pyx_L29;
    }
    __pyx_L29:;
  }
  Py_DECREF(__pyx_5); __pyx_5 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":269 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  Py_INCREF(__pyx_v_P);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_P);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_8 = PyInt_FromLong(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_8, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; goto __pyx_L1;}
  __pyx_4 = __pyx_4 < 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_8); __pyx_8 = 0;
  if (__pyx_4) {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":270 */
    Py_INCREF(Py_None);
    Py_DECREF(__pyx_v_Lcoords);
    __pyx_v_Lcoords = Py_None;
    goto __pyx_L30;
  }
  /*else*/ {

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":272 */
    __pyx_6 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
    __pyx_5 = PyObject_GetAttr(__pyx_6, __pyx_n_array); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
    Py_INCREF(__pyx_v_P);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_P);
    __pyx_1 = PyObject_CallObject(__pyx_5, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_v_P);
    __pyx_v_P = __pyx_1;
    __pyx_1 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":273 */
    /*try:*/ {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":274 */
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_INCREF(__pyx_v_P);
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_P);
      __pyx_8 = PyDict_New(); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      __pyx_6 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      if (PyDict_SetItem(__pyx_8, __pyx_n_full_matrices, __pyx_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      __pyx_5 = PyEval_CallObjectWithKeywords(__pyx_v_svd, __pyx_3, __pyx_8); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_2 = PyObject_GetIter(__pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_1 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_v_u);
      __pyx_v_u = __pyx_1;
      __pyx_1 = 0;
      __pyx_6 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_v_d);
      __pyx_v_d = __pyx_6;
      __pyx_6 = 0;
      __pyx_3 = __Pyx_UnpackItem(__pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_v_vt);
      __pyx_v_vt = __pyx_3;
      __pyx_3 = 0;
      if (__Pyx_EndUnpack(__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L31;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
    }
    /*else:*/ {

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":279 */
      __pyx_5 = PyInt_FromLong(0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
      __pyx_1 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
      __pyx_6 = PyTuple_New(2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_6, 0, __pyx_5);
      PyTuple_SET_ITEM(__pyx_6, 1, __pyx_1);
      __pyx_5 = 0;
      __pyx_1 = 0;
      __pyx_3 = PyObject_GetItem(__pyx_v_vt, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; goto __pyx_L1;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      Py_DECREF(__pyx_v_P);
      __pyx_v_P = __pyx_3;
      __pyx_3 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":280 */
      __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; goto __pyx_L1;}
      __pyx_8 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; goto __pyx_L1;}
      __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
      PyTuple_SET_ITEM(__pyx_5, 1, __pyx_8);
      __pyx_2 = 0;
      __pyx_8 = 0;
      __pyx_1 = PyObject_GetItem(__pyx_v_vt, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_v_Q);
      __pyx_v_Q = __pyx_1;
      __pyx_1 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":283 */
      __pyx_6 = PyInt_FromLong(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      __pyx_3 = PyObject_GetItem(__pyx_v_P, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      __pyx_2 = PyInt_FromLong(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      __pyx_8 = PyObject_GetItem(__pyx_v_Q, __pyx_2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_5 = PyNumber_Multiply(__pyx_3, __pyx_8); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_1 = PyNumber_Negative(__pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_6 = PyInt_FromLong(2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      __pyx_2 = PyObject_GetItem(__pyx_v_P, __pyx_6); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      __pyx_3 = PyInt_FromLong(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      __pyx_8 = PyObject_GetItem(__pyx_v_Q, __pyx_3); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_5 = PyNumber_Multiply(__pyx_2, __pyx_8); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_6 = PyNumber_Add(__pyx_1, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_3 = PyInt_FromLong(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      __pyx_2 = PyObject_GetItem(__pyx_v_P, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_8 = PyInt_FromLong(1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      __pyx_1 = PyObject_GetItem(__pyx_v_Q, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_5 = PyNumber_Multiply(__pyx_2, __pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_3 = PyInt_FromLong(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      __pyx_8 = PyObject_GetItem(__pyx_v_P, __pyx_3); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_2 = PyInt_FromLong(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      __pyx_1 = PyObject_GetItem(__pyx_v_Q, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_3 = PyNumber_Multiply(__pyx_8, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_2 = PyNumber_Subtract(__pyx_5, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_8 = PyInt_FromLong(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      __pyx_1 = PyObject_GetItem(__pyx_v_P, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_5 = PyInt_FromLong(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      __pyx_3 = PyObject_GetItem(__pyx_v_Q, __pyx_5); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_8 = PyNumber_Multiply(__pyx_1, __pyx_3); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_5 = PyNumber_Negative(__pyx_8); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_1 = PyInt_FromLong(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      __pyx_3 = PyObject_GetItem(__pyx_v_P, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_8 = PyInt_FromLong(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      __pyx_1 = PyObject_GetItem(__pyx_v_Q, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_8 = PyNumber_Multiply(__pyx_3, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_3 = PyNumber_Add(__pyx_5, __pyx_8); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_8 = PyInt_FromLong(0); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      __pyx_1 = PyObject_GetItem(__pyx_v_Q, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_8 = PyNumber_Multiply(__pyx_5, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_5 = PyNumber_Negative(__pyx_8); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      __pyx_8 = PyObject_GetItem(__pyx_v_P, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      __pyx_9 = PyObject_GetItem(__pyx_v_Q, __pyx_1); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_1 = PyNumber_Multiply(__pyx_8, __pyx_9); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_8 = PyNumber_Add(__pyx_5, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_9 = PyInt_FromLong(2); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_9); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      __pyx_9 = PyObject_GetItem(__pyx_v_Q, __pyx_1); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_1 = PyNumber_Multiply(__pyx_5, __pyx_9); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_5 = PyNumber_Negative(__pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_9 = PyInt_FromLong(0); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      __pyx_1 = PyObject_GetItem(__pyx_v_P, __pyx_9); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_9 = PyInt_FromLong(2); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      __pyx_10 = PyObject_GetItem(__pyx_v_Q, __pyx_9); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_9 = PyNumber_Multiply(__pyx_1, __pyx_10); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_1 = PyNumber_Add(__pyx_5, __pyx_9); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_10 = PyInt_FromLong(1); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_10); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_9 = PyInt_FromLong(0); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      __pyx_10 = PyObject_GetItem(__pyx_v_Q, __pyx_9); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_9 = PyNumber_Multiply(__pyx_5, __pyx_10); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_5 = PyNumber_Negative(__pyx_9); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_10 = PyInt_FromLong(0); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      __pyx_9 = PyObject_GetItem(__pyx_v_P, __pyx_10); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_10 = PyInt_FromLong(1); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      __pyx_11 = PyObject_GetItem(__pyx_v_Q, __pyx_10); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_10 = PyNumber_Multiply(__pyx_9, __pyx_11); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      Py_DECREF(__pyx_11); __pyx_11 = 0;
      __pyx_9 = PyNumber_Add(__pyx_5, __pyx_10); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_11 = PyTuple_New(6); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_11, 0, __pyx_6);
      PyTuple_SET_ITEM(__pyx_11, 1, __pyx_2);
      PyTuple_SET_ITEM(__pyx_11, 2, __pyx_3);
      PyTuple_SET_ITEM(__pyx_11, 3, __pyx_8);
      PyTuple_SET_ITEM(__pyx_11, 4, __pyx_1);
      PyTuple_SET_ITEM(__pyx_11, 5, __pyx_9);
      __pyx_6 = 0;
      __pyx_2 = 0;
      __pyx_3 = 0;
      __pyx_8 = 0;
      __pyx_1 = 0;
      __pyx_9 = 0;
      Py_DECREF(__pyx_v_Lcoords);
      __pyx_v_Lcoords = __pyx_11;
      __pyx_11 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":289 */
      __pyx_5 = PyInt_FromLong(0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; goto __pyx_L1;}
      __pyx_10 = PyObject_GetItem(__pyx_v_Lcoords, __pyx_5); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; goto __pyx_L1;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      __pyx_7 = PyFloat_AsDouble(__pyx_10); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_4 = isnan(__pyx_7);
      if (__pyx_4) {

        /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":290 */
        Py_INCREF(Py_None);
        Py_DECREF(__pyx_v_Lcoords);
        __pyx_v_Lcoords = Py_None;
        goto __pyx_L33;
      }
      __pyx_L33:;
    }
    goto __pyx_L32;
    __pyx_L31:;
    Py_XDECREF(__pyx_8); __pyx_8 = 0;
    Py_XDECREF(__pyx_5); __pyx_5 = 0;
    Py_XDECREF(__pyx_1); __pyx_1 = 0;
    Py_XDECREF(__pyx_6); __pyx_6 = 0;
    Py_XDECREF(__pyx_3); __pyx_3 = 0;
    Py_XDECREF(__pyx_2); __pyx_2 = 0;

    /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":275 */
    __pyx_8 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
    __pyx_5 = PyObject_GetAttr(__pyx_8, __pyx_n_linalg); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    __pyx_1 = PyObject_GetAttr(__pyx_5, __pyx_n_LinAlgError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_4 = PyErr_ExceptionMatches(__pyx_1);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_4) {
      __Pyx_AddTraceback("reconstruct_utils.hypothesis_testing_algorithm__find_best_3d");
      __pyx_6 = __Pyx_GetExcValue(); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
      Py_DECREF(__pyx_v_err);
      __pyx_v_err = __pyx_6;
      __pyx_6 = 0;

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":276 */
      if (__Pyx_PrintItem(__pyx_k7p) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
      __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_repr); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
      __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
      Py_INCREF(__pyx_v_P);
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_P);
      __pyx_8 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      if (__Pyx_PrintItem(__pyx_8) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}

      /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":277 */
      Py_INCREF(Py_None);
      Py_DECREF(__pyx_v_Lcoords);
      __pyx_v_Lcoords = Py_None;
      goto __pyx_L32;
    }
    goto __pyx_L1;
    __pyx_L32:;
  }
  __pyx_L30:;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":291 */
  __pyx_6 = PyFloat_FromDouble(__pyx_v_mean_dist); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; goto __pyx_L1;}
  Py_INCREF(__pyx_v_X);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_X);
  Py_INCREF(__pyx_v_Lcoords);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_Lcoords);
  Py_INCREF(__pyx_v_cam_ids_used);
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_v_cam_ids_used);
  PyTuple_SET_ITEM(__pyx_2, 3, __pyx_6);
  __pyx_6 = 0;
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  __Pyx_AddTraceback("reconstruct_utils.hypothesis_testing_algorithm__find_best_3d");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_svd);
  Py_DECREF(__pyx_v_cam_ids);
  Py_DECREF(__pyx_v_allA);
  Py_DECREF(__pyx_v_bad_cam_ids);
  Py_DECREF(__pyx_v_cam_id2idx);
  Py_DECREF(__pyx_v_all2d);
  Py_DECREF(__pyx_v_Pmat_fastnx);
  Py_DECREF(__pyx_v_cam_id);
  Py_DECREF(__pyx_v_value_tuple);
  Py_DECREF(__pyx_v_xy_values);
  Py_DECREF(__pyx_v_Pmat);
  Py_DECREF(__pyx_v_row3);
  Py_DECREF(__pyx_v_cam_ids_for_least_err);
  Py_DECREF(__pyx_v_X_for_least_err);
  Py_DECREF(__pyx_v_cam_ids_used);
  Py_DECREF(__pyx_v_good_A_idx);
  Py_DECREF(__pyx_v_A);
  Py_DECREF(__pyx_v_u);
  Py_DECREF(__pyx_v_d);
  Py_DECREF(__pyx_v_vt);
  Py_DECREF(__pyx_v_X);
  Py_DECREF(__pyx_v_new_xyw);
  Py_DECREF(__pyx_v_P);
  Py_DECREF(__pyx_v_area);
  Py_DECREF(__pyx_v_slope);
  Py_DECREF(__pyx_v_eccentricity);
  Py_DECREF(__pyx_v_p1);
  Py_DECREF(__pyx_v_p2);
  Py_DECREF(__pyx_v_p3);
  Py_DECREF(__pyx_v_p4);
  Py_DECREF(__pyx_v_Lcoords);
  Py_DECREF(__pyx_v_err);
  Py_DECREF(__pyx_v_Q);
  Py_DECREF(__pyx_v_recon);
  Py_DECREF(__pyx_v_d2);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_ACCEPTABLE_DISTANCE_PIXELS, "ACCEPTABLE_DISTANCE_PIXELS"},
  {&__pyx_n_False, "False"},
  {&__pyx_n_KeyError, "KeyError"},
  {&__pyx_n_LinAlgError, "LinAlgError"},
  {&__pyx_n_MINIMUM_ECCENTRICITY, "MINIMUM_ECCENTRICITY"},
  {&__pyx_n_Pmat, "Pmat"},
  {&__pyx_n_True, "True"},
  {&__pyx_n_ValueError, "ValueError"},
  {&__pyx_n_allclose, "allclose"},
  {&__pyx_n_append, "append"},
  {&__pyx_n_array, "array"},
  {&__pyx_n_cam_combinations_by_size, "cam_combinations_by_size"},
  {&__pyx_n_cam_ids, "cam_ids"},
  {&__pyx_n_common_variables, "common_variables"},
  {&__pyx_n_dot, "dot"},
  {&__pyx_n_dtype, "dtype"},
  {&__pyx_n_dual, "dual"},
  {&__pyx_n_enumerate, "enumerate"},
  {&__pyx_n_extend, "extend"},
  {&__pyx_n_find_best_3d, "find_best_3d"},
  {&__pyx_n_float64, "float64"},
  {&__pyx_n_flydra, "flydra"},
  {&__pyx_n_full_matrices, "full_matrices"},
  {&__pyx_n_get_K, "get_K"},
  {&__pyx_n_get_nlparams, "get_nlparams"},
  {&__pyx_n_hypothesis_testing_algorithm__find_best_3d, "hypothesis_testing_algorithm__find_best_3d"},
  {&__pyx_n_inf, "inf"},
  {&__pyx_n_len, "len"},
  {&__pyx_n_linalg, "linalg"},
  {&__pyx_n_numpy, "numpy"},
  {&__pyx_n_repr, "repr"},
  {&__pyx_n_svd, "svd"},
  {&__pyx_n_zeros, "zeros"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k2p, __pyx_k2, sizeof(__pyx_k2)},
  {&__pyx_k3p, __pyx_k3, sizeof(__pyx_k3)},
  {&__pyx_k4p, __pyx_k4, sizeof(__pyx_k4)},
  {&__pyx_k7p, __pyx_k7, sizeof(__pyx_k7)},
  {0, 0, 0}
};

static PyObject *__pyx_tp_new_17reconstruct_utils_ReconstructHelper(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  return o;
}

static void __pyx_tp_dealloc_17reconstruct_utils_ReconstructHelper(PyObject *o) {
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_17reconstruct_utils_ReconstructHelper(PyObject *o, visitproc v, void *a) {
  return 0;
}

static int __pyx_tp_clear_17reconstruct_utils_ReconstructHelper(PyObject *o) {
  return 0;
}

static struct PyMethodDef __pyx_methods_17reconstruct_utils_ReconstructHelper[] = {
  {"get_K", (PyCFunction)__pyx_f_17reconstruct_utils_17ReconstructHelper_get_K, METH_VARARGS|METH_KEYWORDS, 0},
  {"get_nlparams", (PyCFunction)__pyx_f_17reconstruct_utils_17ReconstructHelper_get_nlparams, METH_VARARGS|METH_KEYWORDS, 0},
  {"undistort", (PyCFunction)__pyx_f_17reconstruct_utils_17ReconstructHelper_undistort, METH_VARARGS|METH_KEYWORDS, __pyx_doc_17reconstruct_utils_17ReconstructHelper_undistort},
  {"distort", (PyCFunction)__pyx_f_17reconstruct_utils_17ReconstructHelper_distort, METH_VARARGS|METH_KEYWORDS, __pyx_doc_17reconstruct_utils_17ReconstructHelper_distort},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ReconstructHelper = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_ReconstructHelper = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ReconstructHelper = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ReconstructHelper = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_17reconstruct_utils_ReconstructHelper = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "reconstruct_utils.ReconstructHelper", /*tp_name*/
  sizeof(struct __pyx_obj_17reconstruct_utils_ReconstructHelper), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_17reconstruct_utils_ReconstructHelper, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ReconstructHelper, /*tp_as_number*/
  &__pyx_tp_as_sequence_ReconstructHelper, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ReconstructHelper, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ReconstructHelper, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_17reconstruct_utils_ReconstructHelper, /*tp_traverse*/
  __pyx_tp_clear_17reconstruct_utils_ReconstructHelper, /*tp_clear*/
  __pyx_f_17reconstruct_utils_17ReconstructHelper___richcmp__, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_17reconstruct_utils_ReconstructHelper, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_17reconstruct_utils_17ReconstructHelper___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_17reconstruct_utils_ReconstructHelper, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {"hypothesis_testing_algorithm__find_best_3d", (PyCFunction)__pyx_f_17reconstruct_utils_hypothesis_testing_algorithm__find_best_3d, METH_VARARGS|METH_KEYWORDS, __pyx_doc_17reconstruct_utils_hypothesis_testing_algorithm__find_best_3d},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initreconstruct_utils(void); /*proto*/
PyMODINIT_FUNC initreconstruct_utils(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  float __pyx_4;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("reconstruct_utils", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;};
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;};
  if (PyType_Ready(&__pyx_type_17reconstruct_utils_ReconstructHelper) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "ReconstructHelper", (PyObject *)&__pyx_type_17reconstruct_utils_ReconstructHelper) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; goto __pyx_L1;}
  __pyx_ptype_17reconstruct_utils_ReconstructHelper = &__pyx_type_17reconstruct_utils_ReconstructHelper;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":4 */
  __pyx_1 = __Pyx_Import(__pyx_n_numpy, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_numpy, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":5 */
  __pyx_1 = __Pyx_Import(__pyx_k2p, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_numpy, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":6 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_inf); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_inf, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":9 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_inf); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;}
  __pyx_3 = PyFloat_AsDouble(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_v_17reconstruct_utils_cinf = __pyx_3;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":11 */
  __pyx_2 = __Pyx_Import(__pyx_k3p, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_flydra, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":14 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_flydra); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_common_variables); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_MINIMUM_ECCENTRICITY); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyFloat_AsDouble(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_v_17reconstruct_utils_MINIMUM_ECCENTRICITY = __pyx_4;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":17 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_flydra); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_common_variables); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_ACCEPTABLE_DISTANCE_PIXELS); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyFloat_AsDouble(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_17reconstruct_utils_ACCEPTABLE_DISTANCE_PIXELS = __pyx_4;

  /* "/home/astraw/src/kookaburra/flydra/src/reconstruct_utils.pyx":293 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_hypothesis_testing_algorithm__find_best_3d); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_find_best_3d, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("reconstruct_utils");
}

static char *__pyx_filenames[] = {
  "reconstruct_utils.pyx",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    /* Next, repeatedly, replace a tuple exception with its first item */
    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
        PyObject *tmp = type;
        type = PyTuple_GET_ITEM(type, 0);
        Py_INCREF(type);
        Py_DECREF(tmp);
    }
    if (PyString_Check(type)) {
        if (PyErr_Warn(PyExc_DeprecationWarning,
                "raising a string exception is deprecated"))
            goto raise_error;
    }
    else if (PyType_Check(type) || PyClass_Check(type))
        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
    else {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        if (PyInstance_Check(type))
            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
        else
            type = (PyObject*) type->ob_type;
        Py_INCREF(type);
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static PyObject *__Pyx_GetExcValue(void) {
    PyObject *type = 0, *value = 0, *tb = 0;
    PyObject *result = 0;
    PyThreadState *tstate = PyThreadState_Get();
    PyErr_Fetch(&type, &value, &tb);
    PyErr_NormalizeException(&type, &value, &tb);
    if (PyErr_Occurred())
        goto bad;
    if (!value) {
        value = Py_None;
        Py_INCREF(value);
    }
    Py_XDECREF(tstate->exc_type);
    Py_XDECREF(tstate->exc_value);
    Py_XDECREF(tstate->exc_traceback);
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    result = value;
    Py_XINCREF(result);
    type = 0;
    value = 0;
    tb = 0;
bad:
    Py_XDECREF(type);
    Py_XDECREF(value);
    Py_XDECREF(tb);
    return result;
}

static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject("stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}

static int __Pyx_PrintItem(PyObject *v) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_SoftSpace(f, 1)) {
        if (PyFile_WriteString(" ", f) < 0)
            return -1;
    }
    if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
        return -1;
    if (PyString_Check(v)) {
        char *s = PyString_AsString(v);
        int len = PyString_Size(v);
        if (len > 0 &&
            isspace(Py_CHARMASK(s[len-1])) &&
            s[len-1] != ' ')
                PyFile_SoftSpace(f, 0);
    }
    return 0;
}

static int __Pyx_PrintNewline(void) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_WriteString("\n", f) < 0)
        return -1;
    PyFile_SoftSpace(f, 0);
    return 0;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
